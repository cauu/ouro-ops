# ðŸ›¡ï¸ Ouro Ops Product Requirements Document (V1.0)

## 1. Product Overview
* **Product Name**: Ouro Ops
* **Positioning**: A native macOS command center for Cardano and its Partner Chains (e.g., Midnight) Stake Pool Operators (SPOs).
* **Core Philosophy**:
    * **Native Security**: Leverage macOS hardware-level security to protect core assets.
    * **CLI-Driven Operations**: Utilize embedded official binary tools to ensure 100% command compatibility and consistency.
    * **Agentless**: Remote management via SSH protocol, requiring no additional software/agents on the server side.

---

## 2. Core Functional Modules

### 2.1 Ouro Safe: Cold Key & Hardware Security
Solves the conflict between "Air-gap security" and "Operational convenience."
* **Embedded CLI Driver**: The App Bundle includes pre-compiled native macOS versions of `cardano-cli` (and other chain-specific binaries).
* **Local Key Generation**: Invokes the embedded `cardano-cli` via Swift `Process` to execute key generation commands (e.g., `node key-gen`).
    * **Advantage**: Generates official CBOR-formatted keys locally and offline without requiring a connection to a Node Socket.
* **Hardware-Level Storage**: Generated private keys are immediately encrypted and imported into the macOS **Keychain**, protected by the **Secure Enclave**.
* **Biometric Authentication (Touch ID/Face ID)**: Any sensitive operation involving the embedded CLI (signing certificates, rotating KES, or exporting keys) must be authorized via system-level biometrics.



### 2.2 Multi-Network & Multi-Environment Grouping
Designed for complex cross-chain and cross-environment DevOps scenarios.
* **Logical Hierarchy**: Network > Stake Pool > Node.
* **Multi-Toolset Support**: Automatically switches between embedded tools based on network type (e.g., `cardano-cli` for Cardano, specific toolsets for Midnight).
* **Visual Isolation**: Mainnet, Testnets, and Partner Chains feature distinct UI color coding and safety warnings to prevent operational errors.

### 2.3 Agentless Monitoring Center
* **Real-time Data Collection**: Periodically sends non-blocking commands via SSH tunnels.
* **Data Parsing & Rendering**: The App parses `STDOUT` (prioritizing JSON) and updates a native SwiftUI dashboard showing sync progress, KES status, and server metrics.
* **Live Logs**: Native integration of `tail -f` logic to view remote container logs in real-time.

### 2.4 Automated DevOps Toolbox
* **Smart KES Rotation**:
    1.  Fetches the current Slot via API to calculate the KES Period.
    2.  Invokes embedded `cardano-cli` using Cold Keys from the Keychain to sign new certificates.
    3.  Automatically uploads the certificate via SSH and restarts the remote container.
* **Configuration Distribution**: Supports bulk pushing of `topology.json` and other critical config files.

---

## 3. Technical Architecture

### 3.1 Tech Stack
* **Language**: Swift 6 (Swift Concurrency / async-await)
* **UI Framework**: SwiftUI (Optimized for macOS 14.0+)
* **Binary Integration**: **Embedded `cardano-cli` (macOS Mach-O)**.
* **System Calls**: Utilizing `Foundation.Process` and `Pipe` for binary interaction.
* **Security**: LocalAuthentication (Touch ID) + Keychain Services.

### 3.2 Embedded Binary Management
* **Provider Pattern**: A `CLIProvider` class manages binary paths within the App Bundle, handles execution permissions, and encapsulates I/O streams.
* **Atomic Operations**: Ensures all temporary files created during key generation are wiped securely from the disk immediately after the operation.



---

## 4. UI/UX Standards
* **Environment Awareness**: Displays a micro-console at the bottom of the UI when executing local `cardano-cli` operations to keep the user informed.
* **Three-Pane Layout**: Sidebar for grouped navigation, center for real-time monitoring, and right pane for "Ouro Safe" security management.

---

## 5. Security & Constraints
* **Binary Signing**: All embedded tools must be signed and notarized by Apple alongside the main App.
* **Sandboxing**: Strict App Sandbox rules ensure the embedded CLI can only write to the Appâ€™s private container.
* **Memory Isolation**: Sensitive data passed to binaries is handled via Pipes rather than environment variables or temporary files wherever possible.

---

## 6. Roadmap
1.  **Phase 1 (MVP)**: Build the SSH monitoring framework and test the execution logic for embedded binaries.
2.  **Phase 2 (Ouro Safe)**: Implement local key generation, Keychain storage, and Touch ID authorized signing via the embedded CLI.
3.  **Phase 3 (Full Ops)**: Implement automated KES rotation and support for multi-network (Mainnet/Preprod) environments.
4.  **Phase 4 (Partner Chain)**: Integrate Midnight toolsets and support DevOps for Substrate-based nodes.
